{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hemko\\\\OneDrive - Otago Polytechnic\\\\01_Courses\\\\10_Studio_03\\\\03_Others\\\\Eco-shop\\\\src\\\\components\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport Footer from './Footer';\nimport UserProfile from './UserProfile';\nimport CustomerHeader from './Customerheader';\nimport { useUserAuth } from '../context/UserAuthContext';\nimport FBDataService from '../context/FBService';\nimport '../css/Dashboard.css';\nimport CheckoutService from '../context/CheckoutServices'; // Import CheckoutService\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Dashboard() {\n  _s();\n  const {\n    user\n  } = useUserAuth();\n  const [purchasedProducts, setPurchasedProducts] = useState([]);\n  const [userName, setUserName] = useState('');\n\n  // Fetch purchased products and user name\n  useEffect(() => {\n    const fetchPurchasedProducts = async () => {\n      if (user) {\n        try {\n          const querySnapshot = await CheckoutService.getAllCheckouts();\n          console.log(\"QuerySnapshot:\", querySnapshot.docs.map(doc => doc.data())); // Log all checkout documents\n          console.log(\"User ID:\", user.uid); // Log the current user ID\n\n          const productsArray = querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n          })).filter(checkout => checkout.userId === user.uid) // Filter checkouts by user ID\n          .flatMap(checkout => checkout.items); // Extract the `items` array from each checkout document\n\n          console.log(\"Filtered Products Array:\", productsArray); // Log the filtered products array\n\n          setPurchasedProducts(productsArray);\n        } catch (error) {\n          console.error(\"Error fetching purchased products: \", error);\n        }\n      }\n    };\n    const fetchUserName = async () => {\n      if (user) {\n        try {\n          const userDoc = await FBDataService.getData(user.uid); // Fetch user data using UID\n          if (userDoc.exists()) {\n            const userData = userDoc.data();\n            setUserName(userData.name); // Set the user's name\n          } else {\n            console.log(\"No such user!\");\n          }\n        } catch (error) {\n          console.error('Error fetching user data: ', error);\n        }\n      }\n    };\n    fetchPurchasedProducts();\n    fetchUserName(); // Fetch the user's name when the component mounts\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-content\",\n    children: [/*#__PURE__*/_jsxDEV(CustomerHeader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"welcome-message\",\n      children: [\"Welcome to the Dashboard, \", userName, \"!\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-profile\",\n      children: /*#__PURE__*/_jsxDEV(UserProfile, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 43\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"purchased-products\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"section-title\",\n          children: \"Your Purchased Products\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 17\n        }, this), purchasedProducts.length > 0 ? /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"product-list\",\n          children: purchasedProducts.map((product, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"product-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"product-name\",\n              children: product.productName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"product-description\",\n              children: product.productDescription\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"product-price\",\n              children: [\"Price: $\", product.productPrice]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-images\",\n              children: product.imageUrls && product.imageUrls.map((imageUrl, i) => /*#__PURE__*/_jsxDEV(\"img\", {\n                src: imageUrl,\n                alt: product.productName,\n                className: \"product-image\"\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 80,\n                columnNumber: 41\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 33\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"no-products\",\n          children: \"You have not purchased any products yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 9\n  }, this);\n}\n_s(Dashboard, \"RLqYDmUVRPDyjOkrOdXsKAuKsAM=\", false, function () {\n  return [useUserAuth];\n});\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","Footer","UserProfile","CustomerHeader","useUserAuth","FBDataService","CheckoutService","jsxDEV","_jsxDEV","Dashboard","_s","user","purchasedProducts","setPurchasedProducts","userName","setUserName","fetchPurchasedProducts","querySnapshot","getAllCheckouts","console","log","docs","map","doc","data","uid","productsArray","id","filter","checkout","userId","flatMap","items","error","fetchUserName","userDoc","getData","exists","userData","name","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","product","index","productName","productDescription","productPrice","imageUrls","imageUrl","i","src","alt","_c","$RefreshReg$"],"sources":["C:/Users/hemko/OneDrive - Otago Polytechnic/01_Courses/10_Studio_03/03_Others/Eco-shop/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport Footer from './Footer';\r\nimport UserProfile from './UserProfile';\r\nimport CustomerHeader from './Customerheader';\r\nimport { useUserAuth } from '../context/UserAuthContext';\r\nimport FBDataService from '../context/FBService';\r\nimport '../css/Dashboard.css'\r\nimport CheckoutService from '../context/CheckoutServices'; // Import CheckoutService\r\n\r\nfunction Dashboard() {\r\n    const { user } = useUserAuth();\r\n    const [purchasedProducts, setPurchasedProducts] = useState([]);\r\n    const [userName, setUserName] = useState('');\r\n\r\n    // Fetch purchased products and user name\r\n    useEffect(() => {\r\n      const fetchPurchasedProducts = async () => {\r\n          if (user) {\r\n              try {\r\n                  const querySnapshot = await CheckoutService.getAllCheckouts();\r\n                  console.log(\"QuerySnapshot:\", querySnapshot.docs.map(doc => doc.data())); // Log all checkout documents\r\n                  console.log(\"User ID:\", user.uid); // Log the current user ID\r\n  \r\n                  const productsArray = querySnapshot.docs\r\n                      .map(doc => ({\r\n                          id: doc.id,\r\n                          ...doc.data()\r\n                      }))\r\n                      .filter(checkout => checkout.userId === user.uid) // Filter checkouts by user ID\r\n                      .flatMap(checkout => checkout.items); // Extract the `items` array from each checkout document\r\n                  \r\n                  console.log(\"Filtered Products Array:\", productsArray); // Log the filtered products array\r\n  \r\n                  setPurchasedProducts(productsArray);\r\n              } catch (error) {\r\n                  console.error(\"Error fetching purchased products: \", error);\r\n              }\r\n          }\r\n      };\r\n\r\n      const fetchUserName = async () => {\r\n          if (user) {\r\n              try {\r\n                  const userDoc = await FBDataService.getData(user.uid); // Fetch user data using UID\r\n                  if (userDoc.exists()) {\r\n                      const userData = userDoc.data();\r\n                      setUserName(userData.name); // Set the user's name\r\n                  } else {\r\n                      console.log(\"No such user!\");\r\n                  }\r\n              } catch (error) {\r\n                  console.error('Error fetching user data: ', error);\r\n              }\r\n          }\r\n      };\r\n\r\n      fetchPurchasedProducts();\r\n      fetchUserName(); // Fetch the user's name when the component mounts\r\n  }, [user]);\r\n\r\n    return (\r\n        <div className='main-content'>\r\n            <CustomerHeader />\r\n            {/* Display the user's name in the welcome message */}\r\n            <h2 className='welcome-message'>Welcome to the Dashboard, {userName}!</h2>\r\n            <div className='user-profile'><UserProfile /></div>\r\n            <div className='content'>\r\n            {/* Display Purchased Products */}\r\n            <div className=\"purchased-products\">\r\n                <h3 className='section-title'>Your Purchased Products</h3>\r\n                {purchasedProducts.length > 0 ? (\r\n                    <ul className='product-list'>\r\n                        {purchasedProducts.map((product, index) => (\r\n                            <li key={index} className='product-item'>\r\n                                <h4 className='product-name'>{product.productName}</h4>\r\n                                <p className='product-description'>{product.productDescription}</p>\r\n                                <p className='product-price'>Price: ${product.productPrice}</p>\r\n                                <div className='product-images'>\r\n                                    {product.imageUrls && product.imageUrls.map((imageUrl, i) => (\r\n                                        <img\r\n                                            key={i}\r\n                                            src={imageUrl}\r\n                                            alt={product.productName}\r\n                                            className='product-image'\r\n                                        />\r\n                                    ))}\r\n                                </div>\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                ) : (\r\n                    <p className='no-products'>You have not purchased any products yet.</p>\r\n                )}\r\n            </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}